<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Αξιολόγηση Διπλωματικών</title>
<style>
body { font-family: Arial; max-width: 700px; margin:auto; padding:1rem; }
h2 { text-align: center; }
select, input { width: 100%; margin:0.5rem 0; padding:0.5rem; }
button { width:100%; padding:0.5rem; margin-top:0.5rem; }
#gradesForm { margin-top:1rem; }
</style>
</head>
<body>
<h2>Αξιολόγηση Διπλωματικών</h2>

<label for="thesisSelect">Επιλέξτε Διπλωματική:</label>
<select id="thesisSelect"></select>

<div id="gradesForm" style="display:none;">
    <label>Βαθμός Περιεχομένου (0-10):</label>
    <input type="number" id="contentScore" min="0" max="10" step="0.01">
    <label>Βαθμός Οργάνωσης (0-10):</label>
    <input type="number" id="organizationScore" min="0" max="10" step="0.01">
    <label>Βαθμός Παρουσίασης (0-10):</label>
    <input type="number" id="presentationScore" min="0" max="10" step="0.01">
    <button id="submitGradeBtn">Καταχώρηση Βαθμού</button>
</div>

<button id="backBtn">Επιστροφή στο Dashboard</button>

<script>
// Φόρτωση διπλωματικών
fetch('../../api/professor/get_theses_to_evaluate.php')
.then(res=>res.json())
.then(data=>{
    if(!data.success){ alert(data.message); return; }
    const select=document.getElementById('thesisSelect');
    data.theses.forEach(t=>{
        const option=document.createElement('option');
        option.value=t.id;
        option.textContent=t.topic_title + " ("+t.first_name+" "+t.last_name+")";
        select.appendChild(option);
    });
    if(data.theses.length>0) document.getElementById('gradesForm').style.display='block';
});

// Καταχώρηση βαθμού
document.getElementById('submitGradeBtn').addEventListener('click',()=>{
    const thesis_id=document.getElementById('thesisSelect').value;
    const contentScore=parseFloat(document.getElementById('contentScore').value);
    const organizationScore=parseFloat(document.getElementById('organizationScore').value);
    const presentationScore=parseFloat(document.getElementById('presentationScore').value);

    if(isNaN(contentScore) || isNaN(organizationScore) || isNaN(presentationScore)){
        alert("⚠️ Συμπληρώστε όλους τους βαθμούς!");
        return;
    }

    fetch('../../api/professor/submit_grade.php',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({thesis_id, content_score:contentScore, organization_score:organizationScore, presentation_score:presentationScore})
    })
    .then(res=>res.json())
    .then(data=>{
        if(data.success){ alert("✅ "+data.message); }
        else{ alert("❌ "+data.message); }
    });
});

// Επιστροφή στο Dashboard
document.getElementById('backBtn').addEventListener('click',()=>{
    window.location.href='professor_dashboard.html';
});
</script>
</body>
</html>
