<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Εισαγωγή Δεδομένων (JSON)</title>
<style>
body { font-family: Arial; max-width: 600px; margin: auto; padding: 1rem; }
h2 { text-align: center; }
input, button { margin-top: 1rem; width: 100%; padding: 0.5rem; }
#message { margin-top: 1rem; font-weight: bold; }
</style>
</head>
<body>
<h2>Εισαγωγή Δεδομένων</h2>
<p>Επιλέξτε αρχείο JSON με πληροφορίες φοιτητών, καθηγητών και γραμματείας.</p>
<input type="file" id="jsonFile" accept=".json">
<button onclick="uploadData()">Ανέβασμα</button>

<div id="message"></div>

<button onclick="window.location.href='secretary_dashboard.html'">Επιστροφή στο Dashboard</button>

<script>
function uploadData(){
    const fileInput = document.getElementById('jsonFile');
    const messageDiv = document.getElementById('message');

    if(fileInput.files.length === 0){
        messageDiv.textContent = "Παρακαλώ επιλέξτε ένα αρχείο.";
        messageDiv.style.color = "red";
        return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = function(e){
        try {
            const jsonData = JSON.parse(e.target.result);

            fetch('../../api/secretary/import_data.php',{
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(jsonData)
            })
            .then(res => res.json())
            .then(data => {
                messageDiv.textContent = data.message;
                messageDiv.style.color = data.success ? "green" : "red";
            })
            .catch(err => {
                messageDiv.textContent = "Σφάλμα επικοινωνίας με τον server.";
                messageDiv.style.color = "red";
            });

        } catch(err){
            messageDiv.textContent = "Μη έγκυρο JSON αρχείο.";
            messageDiv.style.color = "red";
        }
    };

    reader.readAsText(file);
}
</script>
</body>
</html>
